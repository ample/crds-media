---
layout: default
---
{% assign this_album = site.albums | where:"title", page.album_title | first %}

{% assign videos = "" | split: "" %}
{% for related_video in page.related_videos %}
  {% assign video = site.videos | where: "title", related_video["raw"]["fields"]["title"] | first %}
  {% assign videos = videos | push: video %}
{% endfor %}

{% if page.bg_image %}
  {% assign bg_img = page.bg_image %}
{% else %}
  {% assign bg_img = page.image %}
{% endif %}

<div class="song-detail-tpl">
  <div class="jumbotron jumbotron-xl" style="background-image: url('{{ bg_img | imgix: site.imgix }}'); background-size: cover;" data-optimize-bg-img>
    <div class="bg-overlay"></div>
    <div class="container jumbotron-content">
      <div class="row d-flex flex-column flex-md-row">
        <div class="col-md-7 col-md-offset-1 text-left push-bottom">
          <ol class="breadcrumb hard-sides hard-bottom flush-bottom text-white">
            <li><a href="/">Media</a></li>
            <li><a href="/music">Music</a></li>
          </ol>

          <h2 class="font-family-condensed-extra font-size-giant text-uppercase text-white flush-top push-bottom">{{ page.title }}</h2>

          <div class="font-size-base white-faded markdown">{{ page.content }}</div>
        </div>
        <div class="col-md-3 push-bottom">
          {% include _external-music-links.html %}
        </div>
      </div>
      {% if videos.size > 0 %}
      <div class="row text-left">
        <div class="col-md-10 col-md-offset-1">

          <!-- Featured Video -->
          {% for video in videos limit: 1 %}
            {% if video.source_url %}
              <div class="card relative">
                {% assign video_id = video.source_url | youtube_id %}
                <div class="row push-top soft-top">
                  {% include _yt-embed.html %}
                </div>
                <div class="pull-right">
                  {% include _yt-subscribe-btn.html url="https://www.youtube.com/user/crdschurch" %}
                </div>
                <h6 class="card-title text-white">{{ video.title }}</h6>
                <div class="font-size-smaller">
                  {% if video.topic != nil %}
                    <a class="text-gray-light" href="{{ topic.url }}">{{ video.topic }} &#xB7;</a> 
                  {% endif %}

                  {% for person in video.authors %}
                    {% assign video_author = site.authors | where: "name", person | first %}
                    <a class="text-gray-light" href="{{ video_author.url }}">{{ person }}</a>
                    {% unless forloop.last %}
                    <span class="text-gray-light">&amp;</span>
                    {% endunless %}
                  {% endfor %}
                </div>
              </div>
            {% else %}
              {% include _video-card.html imgix_size="1x" theme="dark" %}
            {% endif %}
          {% endfor %}

          <!-- Other Related Videos -->
          <div class="cards-4x cards-2x-xs">
            <div class="row">
              {% assign other_videos = videos | slice: 1, videos.size %}
              {% for video in other_videos %}
                {% include _video-card.html imgix_size="4x" theme="dark" %}
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<div class="container soft-7-bottom">
  <div class="row push-bottom soft-bottom">
    <div class="col-sm-8 col-sm-offset-2">
      <h3 class="component-header">About This Song</h3>
      <ul class="nav nav-tabs" role="tablist">
        {% if page.details %}
          <li role="presentation" class="active">
            <a href="#details" aria-controls="details" role="tab" data-toggle="tab">Details</a>
          </li>
        {% endif %}

        {% if page.lyrics %}
          <li role="presentation">
            <a href="#lyrics" aria-controls="lyrics" role="tab" data-toggle="tab">Lyrics</a>
          </li>
        {% endif %}

        {% if page.chords %}
          <li role="presentation">
            <a href="#chords" aria-controls="chords" role="tab" data-toggle="tab">Chord Charts</a>
          </li>
        {% endif %}

        {% if page.stems %}
          <li role="presentation">
            <a href="#stems" aria-controls="stems" role="tab" data-toggle="tab">Stems</a>
          </li>
        {% endif %}
      </ul>

      <div class="tab-content markdown">
        <div role="tabpanel" class="tab-pane soft-bottom active" id="details">
          {{ page.details }}
        </div>

        {% if page.lyrics %}
          <div role="tabpanel" class="tab-pane soft-bottom" id="lyrics">
            {{ page.lyrics }}
          </div>
        {% endif %}

        {% if page.chords %}
          <div role="tabpanel" class="tab-pane soft-bottom" id="chords">
            {{ page.chords }}
          </div>
        {% endif %}

        {% if page.stems %}
          <div role="tabpanel" class="tab-pane soft-bottom" id="stems">
            {{ page.stems }}
          </div>
        {% endif %}
      </div>

      <div class="soft-half-top push-top">
        <p>{{ page.date | format_date }} {% if page.audio_duration != nil %}<span class="divider push-quarter-sides">â€¢</span> {{ page.audio_duration }} mins {% endif %}</p>
      </div>

      <div class="push-top">
        {% include _social-share.html %}
      </div>

      <!-- Topic -->
      {% assign topic = site.topics | where: "title", page.topic | first %}
      {% if page.topic %}
        <p class="flush-bottom soft-top">
          <strong>Topic</strong>
        </p>
        <ul class="list-inline">
          <li>
            <a href="{{ topic.url }}">{{ topic.title }}</a>
          </li>
        </ul>
      {% endif %}

      <!-- Tags -->
      {% if page.tags.size > 0 %}
        <p class="flush-bottom soft-half-top">
          <strong>Tags</strong>
        </p>
        <ul class="list-inline">
          {% for tag in page.tags %}
            <li>
              <a href="{{ site.search_domain }}/search?q=tags: '{{ tag }}'" title="Search {{ tag }}">{{ tag }}</a>
            </li>
          {% endfor %}
        </ul>
      {% endif %}

      <!-- Album -->
      {% if page.album_title %}
        <p class="flush-bottom soft-half-top">
          <strong>Album</strong>
        </p>
        <div class="media flush-top">
          <div class="d-flex flex-row-reverse">
            <div class="media-object img-size-6">
              <a href="/albums/{{ page.album_slug }}">
                <img src="{{ page.album_image | imgix: site.imgix }}?{{ site.imgix_params.placeholder }}" sizes="{{ site.image_sizes.album_thumb }}" data-optimize-img />
              </a>
            </div>
          </div>

          <div class="media-body d-flex flex-column justify-content-center align-items-start">
            <a href="/albums/{{ page.album_slug }}">
              {{ page.album_title }}
            </a>
            <div>
            {% for author in this_album.authors %}
              {% assign this_author = site.authors | where:"name", author | first %}
              {% if this_author %}
                <span class="font-size-small text-gray-light">{{ this_author.name }}</span>{% if forloop.last == false %}, {% endif%}
              {% endif %}
            {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}

    </div>
  </div>

  <!-- Recent Songs -->
  {% if site.songs.size > 1 %}
    <div class="push-bottom row">
      <div class="col-sm-8 col-sm-offset-2">

        <section>
          <h2 class="component-header flush-top">Recent Songs</h3>
          <div class="card-deck carousel" data-crds-carousel="mobile-scroll">
            <div class="feature-cards">

              {% assign recent = site.songs | sort: 'date' | reverse %}
              {% for song in recent limit: 9 %}
                {% include _song-card.html %}
              {% endfor %}

            </div>
          </div>
        </section>

      </div>
    </div>
  {% endif %}
</div>
